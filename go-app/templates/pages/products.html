{{define "products.html"}}
<div class="space-y-6">
    <div class="flex justify-between items-center">
        <h2 class="text-2xl font-bold">Products</h2>
        <button onclick="document.getElementById('product-form').classList.toggle('hidden')" class="btn btn-primary btn-sm">+ Add Product</button>
    </div>

    <div id="product-form" class="hidden card bg-base-100 shadow-sm">
        <div class="card-body">
            <h3 class="card-title">New Product</h3>
            <form hx-post="/products" hx-swap="none" class="space-y-4">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div class="md:col-span-3 form-control">
                        <label class="label"><span class="label-text">Name</span></label>
                        <input name="name" required class="input input-bordered">
                    </div>
                    <div class="form-control">
                        <label class="label"><span class="label-text">N %</span></label>
                        <input name="n_pct" type="number" step="0.01" value="0" class="input input-bordered">
                    </div>
                    <div class="form-control">
                        <label class="label"><span class="label-text">P %</span></label>
                        <input name="p_pct" type="number" step="0.01" value="0" class="input input-bordered">
                    </div>
                    <div class="form-control">
                        <label class="label"><span class="label-text">K %</span></label>
                        <input name="k_pct" type="number" step="0.01" value="0" class="input input-bordered">
                    </div>
                    <div class="form-control">
                        <label class="label"><span class="label-text">Fe %</span></label>
                        <input name="fe_pct" type="number" step="0.01" value="0" class="input input-bordered">
                    </div>
                    <div class="form-control">
                        <label class="label"><span class="label-text">Weight (lbs)</span></label>
                        <input name="weight_lbs" type="number" step="0.01" class="input input-bordered">
                    </div>
                    <div class="form-control">
                        <label class="label"><span class="label-text">Cost per Bag ($)</span></label>
                        <input name="cost_per_bag" type="number" step="0.01" class="input input-bordered">
                    </div>
                </div>
                <button type="submit" class="btn btn-primary">Create Product</button>
            </form>
        </div>
    </div>

    {{if .Products}}
    <div class="card bg-base-100 shadow-sm">
        <div class="card-body p-0">
            <div class="overflow-x-auto">
                <table class="table">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th class="text-right">N-P-K</th>
                            <th class="text-right">Fe %</th>
                            <th class="text-right">Weight</th>
                            <th class="text-right">$/Bag</th>
                            <th class="text-right">$/lb N</th>
                            <th class="text-right">$/lb</th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody>
                        {{range .Products}}
                        <tr>
                            <td class="font-medium">{{.Name}}</td>
                            <td class="text-right">{{formatFloat .NPct 1}}-{{formatFloat .PPct 1}}-{{formatFloat .KPct 1}}</td>
                            <td class="text-right">{{formatFloat .FePct 1}}</td>
                            <td class="text-right">{{formatFloatPtr .WeightLbs 1}} lbs</td>
                            <td class="text-right">{{formatFloatPtr .CostPerBag 2}}</td>
                            <td class="text-right">{{formatFloatPtr .CostPerLbN 2}}</td>
                            <td class="text-right">{{formatFloatPtr .CostPerLb 2}}</td>
                            <td>
                                <button hx-delete="/products/{{.ID}}" hx-confirm="Delete product '{{.Name}}'?" class="btn btn-ghost btn-xs text-error">Delete</button>
                            </td>
                        </tr>
                        {{end}}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    {{else}}
    <div class="alert">
        <span>No products yet. Click "Add Product" to create one.</span>
    </div>
    {{end}}
</div>
{{end}}
